<div class="detail-container">
  @if (pollution(); as poll) {
    <div class="detail-card">
      <div class="header">
        <h2>R√©capitulatif de la D√©claration</h2>
        <div class="success-badge">
          <span class="icon">‚úì</span>
          D√©claration enregistr√©e avec succ√®s
        </div>
      </div>

      <!-- Photo Section (if exists) -->
      @if (poll.photoUrl) {
        <div class="photo-section">
          <img [src]="poll.photoUrl" alt="Photo de la pollution" />
        </div>
      }

      <!-- Informations g√©n√©rales -->
      <div class="section">
        <div class="section-header">
          <h3>Informations g√©n√©rales</h3>
        </div>
        <div class="section-content">
          <div class="info-grid">
            <div class="info-item">
              <label for="title">Titre :</label>
              <span id="title">{{ poll.titre }}</span>
            </div>
            <div class="info-item">
              <label for="type-badge">Type de pollution :</label>
              <span class="type-badge" [class]="'type-' + poll.type.toLowerCase()">
                {{ poll.type }}
              </span>
            </div>
            <div class="info-item">
              <label for="date">Date d'observation :</label>
              <span id="date">{{ poll.dateObservation | date: 'medium' }}</span>
            </div>
            <div class="info-item">
              <label for="niveau">Niveau de gravit√© :</label>
              <span class="severity-badge" [class]="'severity-' + poll.niveau">
                {{ poll.niveau }}
              </span>
            </div>
            @if (poll.utilisateur) {
              <div class="info-item">
                <label for="declarant">D√©clar√© par :</label>
                <span id="declarant" class="user-info">
                  üë§ {{ poll.utilisateur.prenom }} {{ poll.utilisateur.nom }}
                  @if (poll.utilisateur.nomUtilisateur) {
                    <small>(&#64;{{ poll.utilisateur.nomUtilisateur }})</small>
                  }
                </span>
              </div>
            }
          </div>
        </div>
      </div>

      <!-- Description -->
      <div class="section">
        <div class="section-header">
          <h3>Description</h3>
        </div>
        <div class="section-content">
          <p class="description-text">{{ poll.description }}</p>
        </div>
      </div>

      <!-- Localisation -->
      <div class="section">
        <div class="section-header">
          <h3>Localisation</h3>
        </div>
        <div class="section-content">
          <div class="info-grid">
            @if (poll.adresse) {
              <div class="info-item full-width">
                <label for="adresse">üìç Adresse :</label>
                <span id="adresse" class="address-value">{{ poll.adresse }}</span>
              </div>
            }
            @if (poll.latitude != null && poll.longitude != null) {
              <div class="info-item full-width">
                <label for="coordinates">üõ∞Ô∏è Coordonn√©es GPS :</label>
                <span class="coordinates" id="coordinates">
                  {{ poll.latitude.toFixed(6) }}, {{ poll.longitude.toFixed(6) }}
                </span>
              </div>
              <div class="info-item">
                <label for="latitude">Latitude :</label>
                <span id="latitude">{{ poll.latitude }}</span>
              </div>
              <div class="info-item">
                <label for="longitude">Longitude :</label>
                <span id="longitude">{{ poll.longitude }}</span>
              </div>
              <div class="info-item full-width">
                <a
                  class="map-link"
                  [href]="'https://www.google.com/maps?q=' + poll.latitude + ',' + poll.longitude"
                  target="_blank"
                  rel="noopener"
                >
                  üó∫Ô∏è Voir sur Google Maps
                </a>
              </div>
            }
            @if (!poll.adresse && poll.latitude == null) {
              <div class="info-item full-width">
                <span class="no-location">Aucune localisation fournie</span>
              </div>
            }
          </div>
        </div>
      </div>

      <!-- Prochaines √©tapes -->
      <div class="section next-steps">
        <div class="section-header">
          <h3>Prochaines √©tapes</h3>
        </div>
        <div class="section-content">
          <ul class="steps-list">
            <li>Votre d√©claration sera transmise aux autorit√©s comp√©tentes</li>
            <li>Un num√©ro de suivi vous sera attribu√© par email</li>
            <li>Vous serez inform√©(e) des actions entreprises</li>
          </ul>
        </div>
      </div>

      <!-- Actions -->
      <div class="actions">
        <button class="btn btn-secondary" routerLink="/pollutions/list">‚Üê Retour</button>
        <button class="btn btn-warning" [routerLink]="['/pollutions/edit', poll.id]">‚úèÔ∏è √âditer</button>
        <button class="btn btn-danger" (click)="deletePollution()">üóëÔ∏è Supprimer</button>
      </div>
    </div>
  } @else if (loading()) {
    <div class="loading-state">
      <div class="spinner"></div>
      <p>Chargement des d√©tails...</p>
    </div>
  } @else {
    <div class="error-state">
      <p>‚ùå Pollution non trouv√©e</p>
      <button class="btn btn-primary" routerLink="/pollutions/list">Retour √† la liste</button>
    </div>
  }
</div>
